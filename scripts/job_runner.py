import os
import subprocess
from enum import Enum
from pathlib import Path

from run_NAVI import get_navi_sequences


class Datasets(Enum):
    SyntheticObjects = "SyntheticObjects"
    GoogleScannedObjects = "GoogleScannedObjects"
    HO3D_eval = "HO3D_eval"
    HO3D_train = "HO3D_train"
    NAVI = "NAVI"
    HANDAL = "HANDAL"
    BOP_HANDAL = "BOP_HANDAL"
    BOP_HANDAL_ONBOARDING = "BOP_HANDAL_ONBOARDING"
    HOPE_ONBOARDING_STATIC = "HOPE_ONBOARDING_STATIC"
    HOPE_ONBOARDING_DYNAMIC = "HOPE_ONBOARDING_DYNAMIC"
    BEHAVE = "BEHAVE"
    TUM_RGBD = "TUM_RGBD"


runners = {
    Datasets.SyntheticObjects: "run_SyntheticObjects.py",
    Datasets.GoogleScannedObjects: "run_GoogleScannedObjects.py",
    Datasets.HO3D_eval: "run_HO3D.py",
    Datasets.HO3D_train: "run_HO3D.py",
    Datasets.NAVI: "run_NAVI.py",
    Datasets.HANDAL: "run_HANDAL.py",
    Datasets.BOP_HANDAL: "run_bop_HANDAL.py",
    Datasets.BOP_HANDAL_ONBOARDING: "run_bop_HANDAL_onboarding.py",
    Datasets.HOPE_ONBOARDING_STATIC: "run_HOPE.py",
    Datasets.HOPE_ONBOARDING_DYNAMIC: "run_HOPE.py",
    Datasets.BEHAVE: "run_BEHAVE.py",
    Datasets.TUM_RGBD: "run_TUM_RGBD.py",
}


def run_batch(configuration_name: str, sequences, dataset: Datasets, output_folder: Path) -> None:
    configuration_path = Path('configs')/(configuration_name + '.py')

    args = []
    args.append("--config")
    args.append(str(configuration_path))
    args.append("--dataset-runner")
    args.append(runners[dataset])
    args.append("--experiment")
    args.append(str(Path(configuration_name).stem))
    args.append("--output-folder")
    args.append(str(output_folder))
    args.append("--sequences")
    args.extend(sequences)

    # Echo the arguments
    print('----------------------------------------')
    print("Running sbatch job.batch with arguments:", args)
    if os.path.basename(os.getcwd()) == "scripts":
        subprocess.run(["sbatch", "job.batch"] + args)
    else:
        print(' '.join(["sbatch", "job.batch"] + args))
        subprocess.run(["sbatch", "scripts/job.batch"] + args)
    print('----------------------------------------')


def create_unused_folder(output_folder: Path):
    # if not os.path.exists(output_folder) or True:
    #     os.makedirs(output_folder, exist_ok=True)
    #     return output_folder
    os.makedirs(output_folder, exist_ok=True)
    return output_folder

    i = 1
    while os.path.exists(f"{output_folder}_{i}"):
        i += 1
    final_output_folder = f"{output_folder}_{i}"
    os.makedirs(final_output_folder, exist_ok=True)

    return final_output_folder


def main():
    configurations = [
        'base_config',
        # 'passthrough',
        # 'sam2_eval',
        'matchability_thresholds/ufm_c005r075',
        'matchability_thresholds/ufm_c005r09',
        'matchability_thresholds/ufm_c005r095',
        'matchability_thresholds/ufm_c005r099',
        'matchability_thresholds/ufm_c01r075',
        'matchability_thresholds/ufm_c01r09',
        'matchability_thresholds/ufm_c01r095',
        'matchability_thresholds/ufm_c01r099',
        'matchability_thresholds/ufm_c025r075',
        'matchability_thresholds/ufm_c025r09',
        'matchability_thresholds/ufm_c025r095',
        'matchability_thresholds/ufm_c025r099',
        'matchability_thresholds/ufm_c05r05',
        'matchability_thresholds/ufm_c05r075',
        'matchability_thresholds/ufm_c05r09',
        'matchability_thresholds/ufm_c05r095',
        'matchability_thresholds/ufm_c05r099',
        'matchability_thresholds/ufm_c075r025',
        'matchability_thresholds/ufm_c075r05',
        'matchability_thresholds/ufm_c075r075',
        'matchability_thresholds/ufm_c075r09',
        'matchability_thresholds/ufm_c075r095',
        'matchability_thresholds/ufm_c075r099',
        'matchability_thresholds/ufm_c09r01',
        'matchability_thresholds/ufm_c09r025',
        'matchability_thresholds/ufm_c09r05',
        'matchability_thresholds/ufm_c09r075',
        'matchability_thresholds/ufm_c09r09',
        'matchability_thresholds/ufm_c09r095',
        'matchability_thresholds/ufm_c09r099',
        'matchability_thresholds/ufm_c095r01',
        'matchability_thresholds/ufm_c095r025',
        'matchability_thresholds/ufm_c095r05',
        'matchability_thresholds/ufm_c095r075',
        'matchability_thresholds/ufm_c095r09',
        'matchability_thresholds/ufm_c095r095',
        'matchability_thresholds/ufm_c095r099',
        'matchability_thresholds/ufm_c0975r01',
        'matchability_thresholds/ufm_c0975r025',
        'matchability_thresholds/ufm_c0975r05',
        'matchability_thresholds/ufm_c0975r075',
        'matchability_thresholds/ufm_c0975r09',
        'matchability_thresholds/ufm_c0975r095',
        'matchability_thresholds/ufm_c0975r099',
        'matchability_thresholds/ufm_c099r01',
        'matchability_thresholds/ufm_c099r025',
        'matchability_thresholds/ufm_c099r05',
        'matchability_thresholds/ufm_c099r075',
        'matchability_thresholds/ufm_c099r09',
        'matchability_thresholds/ufm_c099r095',
        'matchability_thresholds/ufm_c099r099',
    ]

    sequences = {
        Datasets.SyntheticObjects: [
            'Textured_Sphere_5_y',
            # 'Textured_Sphere_5_x',
            # 'Textured_Sphere_5_z',
            # 'Textured_Cube_5_y',
            # 'Textured_Sphere_5_z',
            # 'Textured_Sphere_5_x',
            # 'Textured_Sphere_10_y',
            # 'Translating_Textured_Sphere',
            # 'Textured_Sphere_5_xy',
            # 'Rotating_Translating_Textured_Sphere_5_y',
            # 'Rotating_Translating_Textured_Sphere_5_xy',
            # 'Rotating_Contra_Translating_Textured_Sphere_5_y',
            # 'Rotating_Contra_Translating_Textured_Sphere_5_xy',
            # '8_Colored_Sphere_5_x',
            # '6_Colored_Cube_5_z'
        ],
        Datasets.GoogleScannedObjects: [
            # 'INTERNATIONAL_PAPER_Willamette_4_Brown_Bag_500Count',
            # 'Twinlab_Nitric_Fuel',
            'Squirrel',
            # 'STACKING_BEAR',
            # 'Schleich_Allosaurus',
            'Nestl_Skinny_Cow_Heavenly_Crisp_Candy_Bar_Chocolate_Raspberry_6_pack_462_oz_total',
            # 'SCHOOL_BUS',
            # 'Sootheze_Cold_Therapy_Elephant',
            # 'TOP_TEN_HI',
            'Transformers_Age_of_Extinction_Mega_1Step_Bumblebee_Figure',
        ],
        Datasets.HO3D_eval: [
            'AP10', 'AP12', 'AP14', 'MPM11', 'MPM13', 'SB11', 'SM1',
            'AP11', 'AP13', 'MPM10', 'MPM12', 'MPM14', 'SB13',
        ],
        Datasets.HO3D_train: [
            'ABF10', 'BB10', 'GPMF10', 'GSF10', 'MC1', 'MDF10',  'ND2', 'ShSu12', 'SiBF12', 'SM3', 'SMu41',
            'ABF11', 'BB11', 'GPMF11', 'GSF11', 'MC2', 'MDF11', 'SB10', 'ShSu13', 'SiBF13', 'SM4', 'SMu42',
            'ABF12', 'BB12', 'GPMF12', 'GSF12', 'MC4', 'MDF12', 'SB12', 'ShSu14', 'SiBF14', 'SM5', 'SS1',
            'ABF13', 'BB13', 'GPMF13', 'GSF13', 'MC5', 'MDF13', 'SB14', 'SiBF10', 'SiS1', 'SMu1', 'SS2',
            'ABF14', 'BB14', 'GPMF14', 'GSF14', 'MC6', 'MDF14', 'ShSu10', 'SiBF11', 'SM2', 'SMu40', 'SS3',
            ],
        Datasets.NAVI: get_navi_sequences(),
        Datasets.BOP_HANDAL: [
            '000001_000000', '000001_000001', '000001_000002', '000001_000003', '000001_000004',
            '000002_000000', '000002_000001', '000002_000002', '000002_000003', '000002_000004', '000002_000005',
            '000003_000000', '000003_000001', '000003_000002', '000003_000003', '000003_000004',
            '000004_000000', '000004_000001', '000004_000002', '000004_000003', '000004_000004', '000004_000005',
            '000005_000000', '000005_000001', '000005_000002', '000005_000003', '000005_000004',
            '000006_000000', '000006_000001', '000006_000002', '000006_000003', '000006_000004', '000006_000005',
            '000007_000000', '000007_000001', '000007_000002', '000007_000003', '000007_000004', '000007_000005',
            '000008_000000', '000008_000001', '000008_000002', '000008_000003', '000008_000004',
            '000009_000000', '000009_000001', '000009_000002', '000009_000003', '000009_000004',
            '000010_000000', '000010_000001', '000010_000002', '000010_000003', '000010_000004', '000010_000005',
        ],
        Datasets.HANDAL: [
            "handal_dataset_locking_pliers/007003", "handal_dataset_locking_pliers/007006",
            "handal_dataset_locking_pliers/007007", "handal_dataset_locking_pliers/007005",
            "handal_dataset_locking_pliers/001003",
            "handal_dataset_locking_pliers/091008", "handal_dataset_locking_pliers/001009",
            "handal_dataset_locking_pliers/007001", "handal_dataset_locking_pliers/091011",
            "handal_dataset_locking_pliers/091000",
            "handal_dataset_locking_pliers/091005", "handal_dataset_locking_pliers/007009",
            "handal_dataset_locking_pliers/091003", "handal_dataset_locking_pliers/007004",
            "handal_dataset_locking_pliers/091007",
            "handal_dataset_locking_pliers/091004", "handal_dataset_locking_pliers/001004",
            "handal_dataset_locking_pliers/001002", "handal_dataset_locking_pliers/001007",
            "handal_dataset_locking_pliers/001010",
            "handal_dataset_locking_pliers/007008", "handal_dataset_locking_pliers/091001",
            "handal_dataset_locking_pliers/001006", "handal_dataset_locking_pliers/091006",
            "handal_dataset_locking_pliers/007010",
            "handal_dataset_locking_pliers/007002", "handal_dataset_locking_pliers/001005",
            "handal_dataset_locking_pliers/091002", "handal_dataset_locking_pliers/001008",
            "handal_dataset_slip_joint_pliers/004007",
            "handal_dataset_slip_joint_pliers/004008", "handal_dataset_slip_joint_pliers/099004",
            "handal_dataset_slip_joint_pliers/004005", "handal_dataset_slip_joint_pliers/093004",
            "handal_dataset_slip_joint_pliers/099010",
            "handal_dataset_slip_joint_pliers/004006", "handal_dataset_slip_joint_pliers/099008",
            "handal_dataset_slip_joint_pliers/099003", "handal_dataset_slip_joint_pliers/004009",
            "handal_dataset_slip_joint_pliers/093011",
            "handal_dataset_slip_joint_pliers/093010", "handal_dataset_slip_joint_pliers/099006",
            "handal_dataset_slip_joint_pliers/093009", "handal_dataset_slip_joint_pliers/004004",
            "handal_dataset_slip_joint_pliers/093001",
            "handal_dataset_slip_joint_pliers/093000", "handal_dataset_slip_joint_pliers/099009",
            "handal_dataset_slip_joint_pliers/093002", "handal_dataset_slip_joint_pliers/093008",
            "handal_dataset_slip_joint_pliers/099002",
            "handal_dataset_slip_joint_pliers/093006", "handal_dataset_slip_joint_pliers/099001",
            "handal_dataset_slip_joint_pliers/099007", "handal_dataset_slip_joint_pliers/004002",
            "handal_dataset_slip_joint_pliers/093003",
            "handal_dataset_slip_joint_pliers/004003", "handal_dataset_slip_joint_pliers/004001",
            "handal_dataset_slip_joint_pliers/099005", "handal_dataset_slip_joint_pliers/004010",
            "handal_dataset_strainers/032010",
            "handal_dataset_strainers/035006", "handal_dataset_strainers/032007", "handal_dataset_strainers/023002",
            "handal_dataset_strainers/032002", "handal_dataset_strainers/032001",
            "handal_dataset_strainers/035001", "handal_dataset_strainers/035009", "handal_dataset_strainers/023001",
            "handal_dataset_strainers/023005", "handal_dataset_strainers/023008",
            "handal_dataset_strainers/035010", "handal_dataset_strainers/032005", "handal_dataset_strainers/023004",
            "handal_dataset_strainers/023009", "handal_dataset_strainers/032000",
            "handal_dataset_strainers/023006", "handal_dataset_strainers/035005", "handal_dataset_strainers/035004",
            "handal_dataset_strainers/032009", "handal_dataset_strainers/035003",
            "handal_dataset_strainers/035002", "handal_dataset_strainers/023010", "handal_dataset_strainers/023007",
            "handal_dataset_strainers/032004", "handal_dataset_strainers/032003",
            "handal_dataset_strainers/023003", "handal_dataset_strainers/035000", "handal_dataset_strainers/032006",
            "handal_dataset_strainers/035008", "handal_dataset_strainers/032008",
            "handal_dataset_strainers/035007", "handal_dataset_pots_pans/061010", "handal_dataset_pots_pans/061005",
            "handal_dataset_pots_pans/046008", "handal_dataset_pots_pans/046007",
            "handal_dataset_pots_pans/046006", "handal_dataset_pots_pans/042007", "handal_dataset_pots_pans/046009",
            "handal_dataset_pots_pans/046010", "handal_dataset_pots_pans/042009",
            "handal_dataset_pots_pans/046005", "handal_dataset_pots_pans/061002", "handal_dataset_pots_pans/061007",
            "handal_dataset_pots_pans/061008", "handal_dataset_pots_pans/042006",
            "handal_dataset_pots_pans/042010", "handal_dataset_pots_pans/061009", "handal_dataset_pots_pans/046003",
            "handal_dataset_pots_pans/042005", "handal_dataset_pots_pans/042002",
            "handal_dataset_pots_pans/042001", "handal_dataset_pots_pans/042008", "handal_dataset_pots_pans/046002",
            "handal_dataset_pots_pans/061006", "handal_dataset_pots_pans/061003",
            "handal_dataset_pots_pans/061001", "handal_dataset_pots_pans/061011", "handal_dataset_pots_pans/042004",
            "handal_dataset_pots_pans/046004", "handal_dataset_pots_pans/042003",
            "handal_dataset_pots_pans/046001", "handal_dataset_pots_pans/061004", "handal_dataset_spatulas/003003",
            "handal_dataset_spatulas/003007", "handal_dataset_spatulas/003001",
            "handal_dataset_spatulas/002008", "handal_dataset_spatulas/002010", "handal_dataset_spatulas/010005",
            "handal_dataset_spatulas/002001", "handal_dataset_spatulas/002004",
            "handal_dataset_spatulas/003004", "handal_dataset_spatulas/010001", "handal_dataset_spatulas/010004",
            "handal_dataset_spatulas/002002", "handal_dataset_spatulas/010010",
            "handal_dataset_spatulas/010003", "handal_dataset_spatulas/003009", "handal_dataset_spatulas/003006",
            "handal_dataset_spatulas/002003", "handal_dataset_spatulas/003002",
            "handal_dataset_spatulas/010006", "handal_dataset_spatulas/003008", "handal_dataset_spatulas/002005",
            "handal_dataset_spatulas/010002", "handal_dataset_spatulas/010008",
            "handal_dataset_spatulas/002009", "handal_dataset_spatulas/003010", "handal_dataset_spatulas/010009",
            "handal_dataset_spatulas/002000", "handal_dataset_spatulas/002007",
            "handal_dataset_spatulas/002006", "handal_dataset_spatulas/003005", "handal_dataset_spatulas/010007",
            "handal_dataset_utensils/008009", "handal_dataset_utensils/008007",
            "handal_dataset_utensils/003009", "handal_dataset_utensils/026004", "handal_dataset_utensils/003001",
            "handal_dataset_utensils/003003", "handal_dataset_utensils/008003",
            "handal_dataset_utensils/008010", "handal_dataset_utensils/003010", "handal_dataset_utensils/026010",
            "handal_dataset_utensils/003006", "handal_dataset_utensils/026003",
            "handal_dataset_utensils/008005", "handal_dataset_utensils/003004", "handal_dataset_utensils/003002",
            "handal_dataset_utensils/026007", "handal_dataset_utensils/003005",
            "handal_dataset_utensils/003008", "handal_dataset_utensils/008008", "handal_dataset_utensils/008004",
            "handal_dataset_utensils/008001", "handal_dataset_utensils/026012",
            "handal_dataset_utensils/008006", "handal_dataset_utensils/008002", "handal_dataset_utensils/026011",
            "handal_dataset_utensils/026001", "handal_dataset_utensils/026014",
            "handal_dataset_utensils/026009", "handal_dataset_utensils/026002", "handal_dataset_utensils/003007",
            "handal_dataset_whisks/022005", "handal_dataset_whisks/022002",
            "handal_dataset_whisks/032006", "handal_dataset_whisks/022007", "handal_dataset_whisks/032004",
            "handal_dataset_whisks/022003", "handal_dataset_whisks/023009",
            "handal_dataset_whisks/023001", "handal_dataset_whisks/032002", "handal_dataset_whisks/023002",
            "handal_dataset_whisks/023007", "handal_dataset_whisks/022008",
            "handal_dataset_whisks/032001", "handal_dataset_whisks/032009", "handal_dataset_whisks/022001",
            "handal_dataset_whisks/022010", "handal_dataset_whisks/032005",
            "handal_dataset_whisks/023003", "handal_dataset_whisks/022009", "handal_dataset_whisks/032008",
            "handal_dataset_whisks/032010", "handal_dataset_whisks/023008",
            "handal_dataset_whisks/023010", "handal_dataset_whisks/032003", "handal_dataset_whisks/022006",
            "handal_dataset_whisks/023005", "handal_dataset_whisks/023000",
            "handal_dataset_whisks/032007", "handal_dataset_whisks/022004", "handal_dataset_whisks/023006",
            "handal_dataset_whisks/022000", "handal_dataset_power_drills/003006",
            "handal_dataset_power_drills/061010", "handal_dataset_power_drills/003010",
            "handal_dataset_power_drills/001005", "handal_dataset_power_drills/061002",
            "handal_dataset_power_drills/001002",
            "handal_dataset_power_drills/061008", "handal_dataset_power_drills/003002",
            "handal_dataset_power_drills/061003", "handal_dataset_power_drills/003001",
            "handal_dataset_power_drills/061001",
            "handal_dataset_power_drills/001007", "handal_dataset_power_drills/061007",
            "handal_dataset_power_drills/001008", "handal_dataset_power_drills/061009",
            "handal_dataset_power_drills/003004",
            "handal_dataset_power_drills/061011", "handal_dataset_power_drills/001010",
            "handal_dataset_power_drills/061006", "handal_dataset_power_drills/003007",
            "handal_dataset_power_drills/001003",
            "handal_dataset_power_drills/061005", "handal_dataset_power_drills/001001",
            "handal_dataset_power_drills/001009", "handal_dataset_power_drills/003008",
            "handal_dataset_power_drills/003005",
            "handal_dataset_power_drills/001004", "handal_dataset_power_drills/061004",
            "handal_dataset_power_drills/003009", "handal_dataset_power_drills/003003",
            "handal_dataset_power_drills/001006",
            "handal_dataset_adjustable_wrenches/034005", "handal_dataset_adjustable_wrenches/060002",
            "handal_dataset_adjustable_wrenches/034000", "handal_dataset_adjustable_wrenches/060005",
            "handal_dataset_adjustable_wrenches/060003",
            "handal_dataset_adjustable_wrenches/006009", "handal_dataset_adjustable_wrenches/006004",
            "handal_dataset_adjustable_wrenches/006008", "handal_dataset_adjustable_wrenches/034003",
            "handal_dataset_adjustable_wrenches/006001",
            "handal_dataset_adjustable_wrenches/006002", "handal_dataset_adjustable_wrenches/034008",
            "handal_dataset_adjustable_wrenches/060001", "handal_dataset_adjustable_wrenches/060010",
            "handal_dataset_adjustable_wrenches/006006",
            "handal_dataset_adjustable_wrenches/034004", "handal_dataset_adjustable_wrenches/060004",
            "handal_dataset_adjustable_wrenches/006007", "handal_dataset_adjustable_wrenches/034001",
            "handal_dataset_adjustable_wrenches/034002",
            "handal_dataset_adjustable_wrenches/034009", "handal_dataset_adjustable_wrenches/060009",
            "handal_dataset_adjustable_wrenches/060006", "handal_dataset_adjustable_wrenches/006010",
            "handal_dataset_adjustable_wrenches/006005",
            "handal_dataset_adjustable_wrenches/034007", "handal_dataset_adjustable_wrenches/034006",
            "handal_dataset_adjustable_wrenches/006003", "handal_dataset_adjustable_wrenches/034010",
            "handal_dataset_fixed_joint_pliers/002001",
            "handal_dataset_fixed_joint_pliers/008005", "handal_dataset_fixed_joint_pliers/009005",
            "handal_dataset_fixed_joint_pliers/002009", "handal_dataset_fixed_joint_pliers/008010",
            "handal_dataset_fixed_joint_pliers/008004",
            "handal_dataset_fixed_joint_pliers/009010", "handal_dataset_fixed_joint_pliers/008002",
            "handal_dataset_fixed_joint_pliers/009001", "handal_dataset_fixed_joint_pliers/002008",
            "handal_dataset_fixed_joint_pliers/008001",
            "handal_dataset_fixed_joint_pliers/009007", "handal_dataset_fixed_joint_pliers/002010",
            "handal_dataset_fixed_joint_pliers/008006", "handal_dataset_fixed_joint_pliers/002005",
            "handal_dataset_fixed_joint_pliers/002002",
            "handal_dataset_fixed_joint_pliers/008009", "handal_dataset_fixed_joint_pliers/009009",
            "handal_dataset_fixed_joint_pliers/008008", "handal_dataset_fixed_joint_pliers/008003",
            "handal_dataset_fixed_joint_pliers/009004",
            "handal_dataset_fixed_joint_pliers/002004", "handal_dataset_fixed_joint_pliers/008007",
            "handal_dataset_fixed_joint_pliers/002007", "handal_dataset_fixed_joint_pliers/002003",
            "handal_dataset_fixed_joint_pliers/009008",
            "handal_dataset_fixed_joint_pliers/009006", "handal_dataset_fixed_joint_pliers/002006",
            "handal_dataset_fixed_joint_pliers/009003", "handal_dataset_ratchets/022006", "handal_dataset_ratchets/026003",
            "handal_dataset_ratchets/026006", "handal_dataset_ratchets/061010", "handal_dataset_ratchets/061009",
            "handal_dataset_ratchets/022010", "handal_dataset_ratchets/026005",
            "handal_dataset_ratchets/061007", "handal_dataset_ratchets/061006", "handal_dataset_ratchets/061008",
            "handal_dataset_ratchets/026004", "handal_dataset_ratchets/026000",
            "handal_dataset_ratchets/026001", "handal_dataset_ratchets/022007", "handal_dataset_ratchets/022005",
            "handal_dataset_ratchets/022002", "handal_dataset_ratchets/022008",
            "handal_dataset_ratchets/022000", "handal_dataset_ratchets/022004", "handal_dataset_ratchets/026010",
            "handal_dataset_ratchets/022009", "handal_dataset_ratchets/061001",
            "handal_dataset_ratchets/061002", "handal_dataset_ratchets/022003", "handal_dataset_ratchets/061004",
            "handal_dataset_ratchets/026009", "handal_dataset_ratchets/022001",
            "handal_dataset_ratchets/026002", "handal_dataset_ratchets/026007", "handal_dataset_ratchets/061005",
            "handal_dataset_ratchets/026008", "handal_dataset_hammers/003003",
            "handal_dataset_hammers/012002", "handal_dataset_hammers/003009", "handal_dataset_hammers/012004",
            "handal_dataset_hammers/003007", "handal_dataset_hammers/003005",
            "handal_dataset_hammers/012006", "handal_dataset_hammers/003004", "handal_dataset_hammers/012010",
            "handal_dataset_hammers/012001", "handal_dataset_hammers/003002",
            "handal_dataset_hammers/024003", "handal_dataset_hammers/024010", "handal_dataset_hammers/003001",
            "handal_dataset_hammers/024006", "handal_dataset_hammers/024008",
            "handal_dataset_hammers/024002", "handal_dataset_hammers/024001", "handal_dataset_hammers/012008",
            "handal_dataset_hammers/012007", "handal_dataset_hammers/012000",
            "handal_dataset_hammers/012009", "handal_dataset_hammers/012003", "handal_dataset_hammers/024004",
            "handal_dataset_hammers/003010", "handal_dataset_hammers/003000",
            "handal_dataset_hammers/003008", "handal_dataset_hammers/024005", "handal_dataset_hammers/024007",
            "handal_dataset_hammers/024009", "handal_dataset_hammers/003006",
            "handal_dataset_screwdrivers/004000", "handal_dataset_screwdrivers/012009",
            "handal_dataset_screwdrivers/003001", "handal_dataset_screwdrivers/012000",
            "handal_dataset_screwdrivers/003009",
            "handal_dataset_screwdrivers/004009", "handal_dataset_screwdrivers/003002",
            "handal_dataset_screwdrivers/012001", "handal_dataset_screwdrivers/012005",
            "handal_dataset_screwdrivers/003000",
            "handal_dataset_screwdrivers/004001", "handal_dataset_screwdrivers/004003",
            "handal_dataset_screwdrivers/003010", "handal_dataset_screwdrivers/012002",
            "handal_dataset_screwdrivers/004006",
            "handal_dataset_screwdrivers/004010", "handal_dataset_screwdrivers/004002",
            "handal_dataset_screwdrivers/012008", "handal_dataset_screwdrivers/004008",
            "handal_dataset_screwdrivers/003004",
            "handal_dataset_screwdrivers/004005", "handal_dataset_screwdrivers/004007",
            "handal_dataset_screwdrivers/003003", "handal_dataset_screwdrivers/003006",
            "handal_dataset_screwdrivers/003008",
            "handal_dataset_screwdrivers/012007", "handal_dataset_screwdrivers/003007",
            "handal_dataset_screwdrivers/004004", "handal_dataset_screwdrivers/003005",
            "handal_dataset_screwdrivers/012004",
            "handal_dataset_screwdrivers/012010", "handal_dataset_screwdrivers/012006",
            "handal_dataset_screwdrivers/012003", "handal_dataset_combinational_wrenches/003006",
            "handal_dataset_combinational_wrenches/022002",
            "handal_dataset_combinational_wrenches/026008", "handal_dataset_combinational_wrenches/022001",
            "handal_dataset_combinational_wrenches/022005", "handal_dataset_combinational_wrenches/022010",
            "handal_dataset_combinational_wrenches/003004",
            "handal_dataset_combinational_wrenches/022003", "handal_dataset_combinational_wrenches/026003",
            "handal_dataset_combinational_wrenches/026004", "handal_dataset_combinational_wrenches/022007",
            "handal_dataset_combinational_wrenches/003005",
            "handal_dataset_combinational_wrenches/022004", "handal_dataset_combinational_wrenches/022008",
            "handal_dataset_combinational_wrenches/003009", "handal_dataset_combinational_wrenches/026006",
            "handal_dataset_combinational_wrenches/003001",
            "handal_dataset_combinational_wrenches/026000", "handal_dataset_combinational_wrenches/003000",
            "handal_dataset_combinational_wrenches/026009", "handal_dataset_combinational_wrenches/026005",
            "handal_dataset_combinational_wrenches/026007",
            "handal_dataset_combinational_wrenches/026010", "handal_dataset_combinational_wrenches/026002",
            "handal_dataset_combinational_wrenches/003008", "handal_dataset_combinational_wrenches/003003",
            "handal_dataset_combinational_wrenches/026001",
            "handal_dataset_combinational_wrenches/022009", "handal_dataset_combinational_wrenches/022006",
            "handal_dataset_combinational_wrenches/022000", "handal_dataset_combinational_wrenches/003010",
            "handal_dataset_combinational_wrenches/003002",
            "handal_dataset_combinational_wrenches/003007", "handal_dataset_mugs/024008", "handal_dataset_mugs/022008",
            "handal_dataset_mugs/024010", "handal_dataset_mugs/022001",
            "handal_dataset_mugs/004007", "handal_dataset_mugs/004008", "handal_dataset_mugs/004002",
            "handal_dataset_mugs/024002", "handal_dataset_mugs/022003",
            "handal_dataset_mugs/024009", "handal_dataset_mugs/022004", "handal_dataset_mugs/022007",
            "handal_dataset_mugs/004001", "handal_dataset_mugs/024007",
            "handal_dataset_mugs/024005", "handal_dataset_mugs/022006", "handal_dataset_mugs/004010",
            "handal_dataset_mugs/022002", "handal_dataset_mugs/004009",
            "handal_dataset_mugs/022005", "handal_dataset_mugs/022009", "handal_dataset_mugs/024006",
            "handal_dataset_mugs/024011", "handal_dataset_mugs/024004",
            "handal_dataset_mugs/022010", "handal_dataset_mugs/004005", "handal_dataset_mugs/024001",
            "handal_dataset_mugs/024003", "handal_dataset_mugs/004004",
            "handal_dataset_mugs/004006", "handal_dataset_measuring_cups/017003", "handal_dataset_measuring_cups/012002",
            "handal_dataset_measuring_cups/017002", "handal_dataset_measuring_cups/017004",
            "handal_dataset_measuring_cups/012008", "handal_dataset_measuring_cups/021004",
            "handal_dataset_measuring_cups/012005", "handal_dataset_measuring_cups/017005",
            "handal_dataset_measuring_cups/021007",
            "handal_dataset_measuring_cups/017006", "handal_dataset_measuring_cups/021011",
            "handal_dataset_measuring_cups/021014", "handal_dataset_measuring_cups/012001",
            "handal_dataset_measuring_cups/021001",
            "handal_dataset_measuring_cups/017010", "handal_dataset_measuring_cups/012004",
            "handal_dataset_measuring_cups/017001", "handal_dataset_measuring_cups/017007",
            "handal_dataset_measuring_cups/021003",
            "handal_dataset_measuring_cups/021009", "handal_dataset_measuring_cups/012007",
            "handal_dataset_measuring_cups/012003", "handal_dataset_measuring_cups/021005",
            "handal_dataset_measuring_cups/012006",
            "handal_dataset_measuring_cups/012010", "handal_dataset_measuring_cups/012009",
            "handal_dataset_measuring_cups/017009", "handal_dataset_measuring_cups/021012",
            "handal_dataset_measuring_cups/017008",
            "handal_dataset_measuring_cups/021010", "handal_dataset_ladles/003006", "handal_dataset_ladles/008003",
            "handal_dataset_ladles/008008", "handal_dataset_ladles/010010",
            "handal_dataset_ladles/010007", "handal_dataset_ladles/010002", "handal_dataset_ladles/003001",
            "handal_dataset_ladles/003002", "handal_dataset_ladles/008005",
            "handal_dataset_ladles/003010", "handal_dataset_ladles/008010", "handal_dataset_ladles/010001",
            "handal_dataset_ladles/008001", "handal_dataset_ladles/010008",
            "handal_dataset_ladles/008006", "handal_dataset_ladles/010000", "handal_dataset_ladles/008007",
            "handal_dataset_ladles/003009", "handal_dataset_ladles/008002",
            "handal_dataset_ladles/003003", "handal_dataset_ladles/010006", "handal_dataset_ladles/003005",
            "handal_dataset_ladles/008004", "handal_dataset_ladles/003004",
            "handal_dataset_ladles/010009", "handal_dataset_ladles/008009", "handal_dataset_ladles/003008",
            "handal_dataset_ladles/010005", "handal_dataset_ladles/010003"
        ],
        Datasets.BOP_HANDAL_ONBOARDING: [
            'obj_000001_down', 'obj_000002_down', 'obj_000003_down', 'obj_000004_down', 'obj_000005_down',
            'obj_000006_down', 'obj_000007_down', 'obj_000008_down', 'obj_000009_down', 'obj_000010_down',
            'obj_000011_down', 'obj_000012_down', 'obj_000013_down', 'obj_000014_down', 'obj_000015_down',
            'obj_000016_down', 'obj_000017_down', 'obj_000018_down', 'obj_000019_down', 'obj_000020_down',
            'obj_000021_down', 'obj_000022_down', 'obj_000023_down', 'obj_000024_down', 'obj_000025_down',
            'obj_000026_down', 'obj_000027_down', 'obj_000028_down', 'obj_000029_down', 'obj_000030_down',
            'obj_000031_down', 'obj_000032_down', 'obj_000033_down', 'obj_000034_down',
            'obj_000001_up', 'obj_000002_up', 'obj_000003_up', 'obj_000004_up', 'obj_000005_up',
            'obj_000006_up', 'obj_000007_up', 'obj_000008_up', 'obj_000009_up', 'obj_000010_up',
            'obj_000011_up', 'obj_000012_up', 'obj_000013_up', 'obj_000014_up', 'obj_000015_up',
            'obj_000016_up', 'obj_000017_up', 'obj_000018_up', 'obj_000019_up', 'obj_000020_up',
            'obj_000021_up', 'obj_000022_up', 'obj_000023_up', 'obj_000024_up', 'obj_000025_up',
            'obj_000026_up', 'obj_000027_up', 'obj_000028_up', 'obj_000029_up', 'obj_000030_up',
            'obj_000031_up', 'obj_000032_up', 'obj_000033_up', 'obj_000034_up', 'obj_000035_up',
            'obj_000036_up', 'obj_000037_up', 'obj_000038_up', 'obj_000039_up', 'obj_000040_up',
        ],
        Datasets.HOPE_ONBOARDING_DYNAMIC: [
            'obj_000001_dynamic', 'obj_000006_dynamic', 'obj_000011_dynamic', 'obj_000016_dynamic',
            'obj_000021_dynamic', 'obj_000026_dynamic', 'obj_000002_dynamic', 'obj_000007_dynamic',
            'obj_000012_dynamic', 'obj_000017_dynamic', 'obj_000022_dynamic', 'obj_000027_dynamic',
            'obj_000003_dynamic', 'obj_000008_dynamic', 'obj_000013_dynamic', 'obj_000018_dynamic',
            'obj_000023_dynamic', 'obj_000028_dynamic', 'obj_000004_dynamic', 'obj_000009_dynamic',
            'obj_000014_dynamic', 'obj_000019_dynamic', 'obj_000024_dynamic', 'obj_000005_dynamic',
            'obj_000010_dynamic', 'obj_000015_dynamic', 'obj_000020_dynamic', 'obj_000025_dynamic',
        ],
        Datasets.HOPE_ONBOARDING_STATIC: [
            'obj_000001_up', 'obj_000006_up', 'obj_000011_up', 'obj_000016_up',
            'obj_000021_up', 'obj_000026_up', 'obj_000002_up', 'obj_000007_up',
            'obj_000012_up', 'obj_000017_up', 'obj_000022_up', 'obj_000027_up',
            'obj_000003_up', 'obj_000008_up', 'obj_000013_up', 'obj_000018_up',
            'obj_000023_up', 'obj_000028_up', 'obj_000004_up', 'obj_000009_up',
            'obj_000014_up', 'obj_000019_up', 'obj_000024_up', 'obj_000005_up',
            'obj_000010_up', 'obj_000015_up', 'obj_000020_up', 'obj_000025_up',
            'obj_000001_down', 'obj_000006_down', 'obj_000011_down', 'obj_000016_down',
            'obj_000021_down', 'obj_000026_down', 'obj_000002_down', 'obj_000007_down',
            'obj_000012_down', 'obj_000017_down', 'obj_000022_down', 'obj_000027_down',
            'obj_000003_down', 'obj_000008_down', 'obj_000013_down', 'obj_000018_down',
            'obj_000023_down', 'obj_000028_down', 'obj_000004_down', 'obj_000009_down',
            'obj_000014_down', 'obj_000019_down', 'obj_000024_down', 'obj_000005_down',
            'obj_000010_down', 'obj_000015_down', 'obj_000020_down', 'obj_000025_down',
        ],
        Datasets.BEHAVE: [
            # '225z4rz6dtrsezi34lsrcnukni',
            # '227ybq4jddcxeobo7njvjnkmgy',
            # '24bw7vtbjt3ony3cgvye2oyjgu',
            # '24n2fzuerdocahja7fxod3jzfe',
            # '25zqalav3mxmbuvwzrgdxvp6ne',
            # '26623u6vetquo3323cyano7xpu',
            # '27pfmpfuewryv7u2vqe56sbsua',
            # '2ayiktcgtfbj45woxvfv74plui',
            # '2b2o7cfrp6j5luxwixtq2syeoy',
            # '2csdgc36d5txks6kpssnrojmby',
        ],
        Datasets.TUM_RGBD: [
            # 'rgbd_dataset_freiburg1_360',
            # 'rgbd_dataset_freiburg1_desk',
            # 'rgbd_dataset_freiburg1_desk2',
            # 'rgbd_dataset_freiburg1_floor',
            # 'rgbd_dataset_freiburg1_plant',
            # 'rgbd_dataset_freiburg1_room',
            # 'rgbd_dataset_freiburg1_rpy',
            # 'rgbd_dataset_freiburg1_teddy',
            # 'rgbd_dataset_freiburg1_xyz',
            # 'rgbd_dataset_freiburg2_360_hemisphere',
            # 'rgbd_dataset_freiburg2_360_kidnap',
            # 'rgbd_dataset_freiburg2_coke',
            # 'rgbd_dataset_freiburg2_desk',
            # 'rgbd_dataset_freiburg2_dishes',
            # 'rgbd_dataset_freiburg2_flowerbouquet',
            # 'rgbd_dataset_freiburg2_flowerbouquet_brownbackground',
            # 'rgbd_dataset_freiburg2_large_no_loop',
            # 'rgbd_dataset_freiburg2_large_with_loop',
            # 'rgbd_dataset_freiburg2_metallic_sphere',
            # 'rgbd_dataset_freiburg2_metallic_sphere2',
            # 'rgbd_dataset_freiburg2_pioneer_360',
            # 'rgbd_dataset_freiburg2_pioneer_slam',
            # 'rgbd_dataset_freiburg2_pioneer_slam2',
            # 'rgbd_dataset_freiburg2_pioneer_slam3',
            # 'rgbd_dataset_freiburg2_rpy',
            # 'rgbd_dataset_freiburg2_xyz',
            # 'rgbd_dataset_freiburg3_cabinet',
            # 'rgbd_dataset_freiburg3_large_cabinet',
            # 'rgbd_dataset_freiburg3_long_office_household',
            # 'rgbd_dataset_freiburg3_sitting_halfsphere',
            # 'rgbd_dataset_freiburg3_sitting_rpy',
            # 'rgbd_dataset_freiburg3_sitting_static',
            # 'rgbd_dataset_freiburg3_sitting_xyz',
            # 'rgbd_dataset_freiburg3_teddy',
            # 'rgbd_dataset_freiburg3_walking_halfsphere',
            # 'rgbd_dataset_freiburg3_walking_rpy',
            # 'rgbd_dataset_freiburg3_walking_static',
            # 'rgbd_dataset_freiburg3_walking_xyz',
        ],
    }

    # Set batch length
    batch_length = 1

    for configuration in configurations:

        output_folder_root = Path("/mnt/personal/jelint19/results/FlowTracker/")
        output_folder = output_folder_root/configuration
        output_folder = create_unused_folder(output_folder)

        for dataset in sequences:
            seq_index = 0
            while seq_index < len(sequences[dataset]):
                batch_seqs = sequences[dataset][seq_index:seq_index + batch_length]
                run_batch(configuration, batch_seqs, dataset, output_folder)
                seq_index += batch_length


if __name__ == "__main__":
    main()
